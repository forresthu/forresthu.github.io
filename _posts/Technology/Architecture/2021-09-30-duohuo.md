---

layout: post
title: 多活
category: Architecture
tags: Architecture
keywords: 多活

---

## 简介（未完成）

* TOC
{:toc}



[揭开腾讯云原生同城双活的秘密](https://mp.weixin.qq.com/s/fGpvilPyQKbLT72zOui79A) 对四个阶段的架构设计及特点做了详细介绍
1. 数据冷备：实现简单，无需业务改造
2. 在线热备：因为冷备只备了数据，故障恢复的时候需要把业务布起来，恢复的时间比较久，所以出现了在线的热备，但是热备常态下备份不提供在线服务，导致资源大量浪费，且可靠性难保障
3. 同城双活：相比于异地多活实现起来较简单，业务改动较少，可以提供在线服务，让资源有效利用，故障恢复时间比较短
4. 异地多活：多活实现比较复杂，需要业务去做Set化的改造，同时运维也比较复杂，但它的优势是故障恢复时间非常短。每个地域或者每个数据中心都会同时接入写入流量，用户的请求或者访问在单个数据中心去实现交易的闭环。
    1. 仅业务层多活。 存储层主集群部署在一个机房，业务层写请求还是写到主机房。
    2. 业务层多活，存储层支持多主多从。


[云原生环境下对“多活”架构的思考](https://mp.weixin.qq.com/s/cjTe2SV-ByZgz2hpiTFkzA)

## 同城双活

前置条件是：
1. 数据服务支持实时增量同步，
2. 接入层/应用层无状态，
3. 应用层可接受跨区访问数据层增加的网络/数据延迟；
改造代价是：
1. 中间件实现自动流量调度，以及数据层故障HA自动切换，
2. 本可用区应用无跨区访问，或优先访问本可用区实例。

![](/public/upload/architecture/active_active.png)





